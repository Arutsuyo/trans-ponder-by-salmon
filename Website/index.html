<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
    <title>Resource Directory</title>
     <meta charset="UTF-8">
    <!-- 'viewport' is used by bootstrap to respond to device size -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Javascript:  JQuery from a content distribution network (CDN) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js">
    </script>

    <!-- Bootstrap includes javascript and css  (must follow jquery) -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js">
    </script>

    <!-- Our own style sheet -->
    <link rel="stylesheet" href="css/style.css" />
    <script type="text/javascript">
          var SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
          var CREATE_URL = SCRIPT_ROOT + "/_create";
          var DEL_URL = SCRIPT_ROOT + "/_del";
          var INIT_URL = SCRIPT_ROOT + "/_disp";

          function load_resources() {
            // A function to run on page load to update the page
            // with resources already in the db.
            console.log("Displaying Entries: ");
            $.getJSON(INIT_URL, {}, function(data) {
                 var resources = data.result;
                 show_me_the_resources(resources)
            });
          }

          function show_me_the_resources(recs){
            var resources = recs.resources;
            var table = document.getElementById('resource_table');
            // First, clear the old resource table. Uses some code from:
            // https://stackoverflow.com/questions/3955229/remove-all-child-elements-of-a-dom-node-in-javascript
            while (table.firstChild) {
                table.removeChild(table.firstChild);
            }

            var resource_table = document.createElement('tbody');
            table.appendChild(resource_table);

            // Add the current resources to the table
            console.log("Showing " + resources.length + " resources.");

            for (var i = 0; i < resources.length; i++) {
              console.log(resources[i]);

              // First a row with the date:
              resource_table.insertRow().outerHTML = "<tr>" + resources[i].disp_date + ": </tr>";
              // Next a textarea with the resource and a delete button next to it
              resource_table.insertRow().outerHTML = "<tr class='the_row'> <td> <textarea readonly name='resource' rows='4' cols='30'>"
                  + resources[i].text
                  + "</textarea> </td> <td> <input name='remove' id='remove' type='submit' value='Delete'/> </td> </tr>";

              // Index to the delete button that was just created:
              var resource_row = resource_table.rows[3*i + 1].childNodes;
              var del_btn = $(resource_row[3]).parents(".the_row").find("input[name='remove']");
              // Add a listener for that button
              var btn_id = resources[i].index;
              make_listener(del_btn, btn_id)
            }
          }

          $(document).ready(function(){onPageLoad();});
          function onPageLoad(){
            // Display the resources already in the database.
            load_resources()
          }
          $(document).ready(function(){
            console.log("Page loaded");
            stuff_from_database();
            populate_cal_table();
          $('input[type=checkbox]').change(
            function(){
                if (this.checked) {
                    alert('checked');
                }
          });
        });
    </script>
</head>

<body>
    <img id="tplogo" src="img/tplogo.png" height="90px" width="90px">
    <div id="sorting_options">
        <!-- based on instructions from W3 Schools -->
        <div id="dropdown">
            <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Service Type
     <span class="caret"></span></button>
            <ul class="dropdown-menu">
                <li><a href="#">Chiropractor</a></li>
                <li><a href="#">Psychologist</a></li>
                <li><a href="#">Endocrinologist</a></li>
                <li><a href="#">Gynecologist</a></li>
                <li><a href="#">Social Support</a></li>
                <li><a href="#">Laser / Electrolysis</a></li>
                <li><a href="#">Surgeon</a></li>
                <li><a href="#">Surgery Scholarship</a></li>
                <li><a href="#">Therapist / Counselor</a></li>
                <li><a href="#">Voice Therapy</a></li>
                <li><a href="#">Youth Support</a></li>
                <li><a href="#">Hair</a></li>
                <li><a href="#">Gender Affirming Products</a></li>
            </ul>
        </div>

        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="box_OHP" value="option1">
            <label class="form-check-label" for="inlineCheckbox1">Takes Oregon Health Plan</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="box_PI" value="option2">
            <label class="form-check-label" for="inlineCheckbox2">Takes Private Insurance</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="box_MH" value="option3">
            <label class="form-check-label" for="inlineCheckbox3">Can Monitor Hormones</label>
        </div>

    </div>
    <div class="container">

        <h2>Current Resources: </h2>
        <!-- Table to be filled in by js functions -->
        <table id="resource_table">
            <tbody>
                <template class="resource">
                    <!-- <div class = "r_img_div"> <img src = "baa3.png" class = "r_image" width = "150" height = "150" > </div> -->
                    <div r_head>
                        <div id="r_titleDiv">
                            <h3 id="r_title">PLACEHOLDER TITLE</h3>
                        </div>
                        <h4 id="r_category">Category</h4>
                        </br>
                        <div id="r_providerName">ProviderName</div>
                    </div>
                    <ul id="r_contactInfo">
                        <li><b>Website:</b> <span id="r_url">N/A</span></li>
                        <li><b>Email:</b> <span id="r_email">N/A</span></li>
                        <li><b>Phone #:</b> <span id="r_phone">N/A</span></li>
                        <li><b>Address:</b> <span id="r_address">N/A</span></li>
                        <li><b>Office:</b> <span id="r_officeName">N/A</span></li>
                    </ul>

                    <ul id="r_perks">
                        <li id="r_takesOHP">N</li>
                        <li id="r_takesInsurance">N</li>
                        <li id="r_takesInsurance">N</li>
                        <li id="r_takesInsurance">N</li>
                        <li id="r_takesInsurance">N</li>
                    </ul>
                </template>
            </tbody>
        </table>
        <br />
    </div>
</body>
<footer>
    <div id="contact"></div>
    <div id="bottom-bar"></div>
</footer>
</html>
